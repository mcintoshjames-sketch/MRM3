============================= test session starts ==============================
platform darwin -- Python 3.11.14, pytest-7.4.4, pluggy-1.6.0 -- /opt/homebrew/opt/python@3.11/bin/python3.11
cachedir: .pytest_cache
rootdir: /Users/jamesmcintosh/Desktop/mrm_inv_3/api
configfile: pytest.ini
plugins: anyio-4.12.0, cov-4.1.0, asyncio-0.21.1
asyncio: mode=Mode.STRICT
collecting ... collected 22 items

api/tests/test_security_hardening.py::TestAnalyticsSecurity::test_analytics_valid_select PASSED [  4%]
api/tests/test_security_hardening.py::TestAnalyticsSecurity::test_analytics_invalid_dml PASSED [  9%]
api/tests/test_security_hardening.py::TestAnalyticsSecurity::test_analytics_multiple_statements PASSED [ 13%]
api/tests/test_security_hardening.py::TestAnalyticsSecurity::test_analytics_non_admin PASSED [ 18%]
api/tests/test_security_hardening.py::TestUserSelfUpdate::test_update_me_success PASSED [ 22%]
api/tests/test_security_hardening.py::TestUserSelfUpdate::test_update_me_wrong_current_password PASSED [ 27%]
api/tests/test_security_hardening.py::TestUserSelfUpdate::test_update_me_restricted_fields PASSED [ 31%]
api/tests/test_security_hardening.py::TestConfigValidation::test_validate_dev_settings PASSED [ 36%]
api/tests/test_security_hardening.py::TestConfigValidation::test_validate_prod_default_secret PASSED [ 40%]
api/tests/test_security_hardening.py::TestConfigValidation::test_validate_prod_short_secret PASSED [ 45%]
api/tests/test_security_hardening.py::TestConfigValidation::test_validate_prod_default_db PASSED [ 50%]
api/tests/test_jwt_security.py::test_decode_token_accepts_valid_issuer_and_audience PASSED [ 54%]
api/tests/test_jwt_security.py::test_decode_token_rejects_wrong_issuer PASSED [ 59%]
api/tests/test_jwt_security.py::test_decode_token_rejects_wrong_audience PASSED [ 63%]
api/tests/test_jwt_security.py::test_decode_token_rejects_wrong_algorithm PASSED [ 68%]
api/tests/test_sec01_addendum.py::test_readonly_role_switch_applied PASSED [ 72%]
api/tests/test_sec01_addendum.py::test_extra_timeouts_set PASSED         [ 77%]
api/tests/test_sec01_addendum.py::test_dangerous_functions_allowed PASSED [ 81%]
api/tests/test_sec01_addendum.py::test_explain_analyze_allowed PASSED    [ 86%]
api/tests/test_sec01_addendum.py::test_sql_wrapping_applied PASSED       [ 90%]
api/tests/test_sec01_addendum.py::test_sql_wrapping_with_user_limit PASSED [ 95%]
api/tests/test_sec01_addendum.py::test_missing_role_in_production_returns_error PASSED [100%]

=============================== warnings summary ===============================
../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_config.py:271: 193 warnings
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_config.py:271: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_id" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_types" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_count" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_name" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_type_id" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_last_updated" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_type" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_owner" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_ids" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_code" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_change_lead_time_days" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_versions" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_documentation_version" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_submission_version" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_documentation_id" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_validation_due_date" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_compliance_status" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_names" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_details" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_driven" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_owner_id" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_owner_name" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_owner_email" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_developer_name" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_snapshots" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_version_id" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_version" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:88
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:88
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:88
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:88
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:88
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:88
  /opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:88: DeprecationWarning: 'parseString' deprecated - use 'parse_string'
    parse = parser.parseString(pattern)

../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:92
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:92
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:92
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:92
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:92
../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:92
  /opt/homebrew/lib/python3.11/site-packages/matplotlib/_fontconfig_pattern.py:92: DeprecationWarning: 'resetCache' deprecated - use 'reset_cache'
    parser.resetCache()

../../../../opt/homebrew/lib/python3.11/site-packages/matplotlib/_mathtext.py:45
  /opt/homebrew/lib/python3.11/site-packages/matplotlib/_mathtext.py:45: DeprecationWarning: 'enablePackrat' deprecated - use 'enable_packrat'
    ParserElement.enablePackrat()

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_risk_tier" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../../opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149
  /opt/homebrew/lib/python3.11/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_status" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

tests/test_security_hardening.py::TestAnalyticsSecurity::test_analytics_valid_select
tests/test_security_hardening.py::TestAnalyticsSecurity::test_analytics_invalid_dml
tests/test_security_hardening.py::TestAnalyticsSecurity::test_analytics_multiple_statements
tests/test_security_hardening.py::TestAnalyticsSecurity::test_analytics_non_admin
tests/test_security_hardening.py::TestUserSelfUpdate::test_update_me_success
tests/test_security_hardening.py::TestUserSelfUpdate::test_update_me_wrong_current_password
tests/test_security_hardening.py::TestUserSelfUpdate::test_update_me_restricted_fields
  /Users/jamesmcintosh/Desktop/mrm_inv_3/api/tests/conftest.py:50: SAWarning: Can't sort tables for DROP; an unresolvable foreign key dependency exists between tables: model_versions, validation_requests; and backend does not support ALTER.  To restore at least a partial sort, apply use_alter=True to ForeignKey and ForeignKeyConstraint objects involved in the cycle to mark these as known cycles that will be ignored.
    Base.metadata.drop_all(bind=engine)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 22 passed, 244 warnings in 2.30s =======================
